Thousands evacuated as record rains pound northern Japan