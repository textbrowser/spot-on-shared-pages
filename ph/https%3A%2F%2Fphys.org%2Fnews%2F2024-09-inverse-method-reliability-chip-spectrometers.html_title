Inverse-design method enhances performance and reliability of on-chip spectrometers