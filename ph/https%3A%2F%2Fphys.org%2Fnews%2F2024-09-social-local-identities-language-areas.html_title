Social connections and local identities found to influence how language spreads in different areas