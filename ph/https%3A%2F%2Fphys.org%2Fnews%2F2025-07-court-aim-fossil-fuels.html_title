Top court takes aim at fossil fuels in sweeping ruling