General framework bridges quantum thermodynamics and non-Markovianity