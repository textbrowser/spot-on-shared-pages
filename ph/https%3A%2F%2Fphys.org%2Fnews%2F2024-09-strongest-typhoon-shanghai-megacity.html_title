Strongest typhoon to hit Shanghai since 1949 shuts down megacity