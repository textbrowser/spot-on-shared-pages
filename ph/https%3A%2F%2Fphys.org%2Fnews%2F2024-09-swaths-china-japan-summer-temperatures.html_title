Swaths of China, Japan log record summer temperatures